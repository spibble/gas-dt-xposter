<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous">
</script>

<script>
  $(document).ready(function() {  
    $('#config-form').submit(onConfigFormSubmit);
    var status = $('#submit-status');
    status.hide();
  })

  function showStatus(message) {
    var status = $('#submit-status');
    status.removeClass('error')
    status.text(message);
    status.show();
  }

  function onConfigFormSubmit(event) {
    event.preventDefault();
    this.disabled = true;
    showStatus('Adding to secrets...');

    const form = document.getElementById('config-form');
    const elements = form.elements;
    /*
    *  vals[0]: discord channel webhook
    *  vals[1]: discord webhook username
    *  vals[2]: telegram bot token
    *  vals[3]: telegram channel
    */
    const vals = [];

    for (let i = 0; i < elements.length; i++) {
        const currentElement = elements[i];

        if (currentElement.tagName === 'INPUT' && currentElement.type === 'text') {
            vals[i] = currentElement.value;
        }
    }
    google.script.run
      .saveSecrets(vals);

    showStatus('Done!');
  }
</script>